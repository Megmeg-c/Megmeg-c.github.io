<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>台灣小吃大作戰</title>
    <link rel="icon" href="diet.png" type="image/png">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="game-container">
        <div id="ui-layer">
            <div id="score-board">分數: <span id="score">0</span></div>
            <button id="start-btn">START</button>
            <div id="game-over-text" style="display: none;">遊戲結束</div>
        </div>
        
        <div id="game-area">
            <img src="box.png" id="basket">
        </div>
    </div>

    <section id="rules">
        <h3>🍱 遊戲規則說明</h3>
        <ul>
            <li><strong>如何開始：</strong> 點擊上方的 「START」 按鈕。</li>
            <li><strong>如何操作：</strong> 使用鍵盤左右方向鍵 (← →) 移動籃子。</li>
            <li><strong>何時加分：</strong> 接到掉落的小吃加 1 分。</li>
            <li><strong>何時結束：</strong> 任何一個小吃掉出畫面底部，遊戲即結束。</li>
        </ul>
    </section>

    <script src="script.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>台灣小吃大作戰</title>
    <link rel="icon" href="diet.png" type="image/png">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="game-container">
        <div id="ui-layer">
            <div id="score-board">分數: <span id="score">0</span></div>
            <button id="start-btn">START</button>
            <div id="game-over-text" style="display: none;">遊戲結束</div>
        </div>
        
        <div id="game-area">
            <img src="box.png" id="basket">
        </div>
    </div>

    <section id="rules">
        <h3>🍱 遊戲規則說明</h3>
        <ul>
            <li><strong>如何開始：</strong> 點擊上方的 「START」 按鈕。</li>
            <li><strong>如何操作：</strong> 使用鍵盤左右方向鍵 (← →) 移動籃子。</li>
            <li><strong>何時加分：</strong> 接到掉落的小吃加 1 分。</li>
            <li><strong>何時結束：</strong> 任何一個小吃掉出畫面底部，遊戲即結束。</li>
        </ul>
    </section>

    <script src="script.js"></script>
</body>
</html>
const gameArea = document.getElementById('game-area');
const basket = document.getElementById('basket');
const scoreDisplay = document.getElementById('score');
const startBtn = document.getElementById('start-btn');
const gameOverText = document.getElementById('game-over-text');

let score = 0;
let gameActive = false;
let basketX = 175;
let spawnTimer; // 用來存放產生物品的計時器
let gameLoop;  // 用來存放遊戲邏輯更新的計時器

// 監聽鍵盤
document.addEventListener('keydown', (e) => {
    if (!gameActive) return;
    if (e.key === 'ArrowLeft' && basketX > 0) {
        basketX -= 20;
    } else if (e.key === 'ArrowRight' && basketX < 350) {
        basketX += 20;
    }
    basket.style.left = basketX + 'px';
});

// 開始遊戲
startBtn.addEventListener('click', startGame);

function startGame() {
    // 1. 清除舊有的計時器，防止 Bug
    clearInterval(spawnTimer);
    clearInterval(gameLoop);

    // 2. 清空畫面上的舊食物
    const oldFoods = document.querySelectorAll('.food');
    oldFoods.forEach(f => f.remove());

    // 3. 重置數值
    score = 0;
    scoreDisplay.innerText = score;
    gameActive = true;
    basketX = 175;
    basket.style.left = basketX + 'px';
    startBtn.style.display = 'none';
    gameOverText.style.display = 'none';

    // 4. 設定新計時器
    spawnTimer = setInterval(createFood, 1000); // 每一秒出一個
    gameLoop = setInterval(updateGame, 20);      // 每 20 毫秒更新畫面
}

function createFood() {
    if (!gameActive) return;
    const food = document.createElement('img');
    const foodType = Math.floor(Math.random() * 5) + 1; // 1~5
    food.src = `food_${foodType}.png`;
    food.classList.add('food');
    
    // 隨機橫向位置
    food.style.left = Math.floor(Math.random() * 360) + 'px';
    food.style.top = '0px';
    gameArea.appendChild(food);
}

function updateGame() {
    const foods = document.querySelectorAll('.food');
    
    foods.forEach(food => {
        let top = parseInt(food.style.top);
        top += 5; // 掉落速度
        food.style.top = top + 'px';

        // 碰撞判斷
        const foodRect = food.getBoundingClientRect();
        const basketRect = basket.getBoundingClientRect();

        if (
            foodRect.bottom >= basketRect.top &&
            foodRect.right >= basketRect.left &&
            foodRect.left <= basketRect.right &&
            foodRect.top <= basketRect.bottom
        ) {
            food.remove();
            score++;
            scoreDisplay.innerText = score;
        }

        // 遊戲結束判定：如果掉到底部沒接到
        if (top > 500) {
            endGame();
        }
    });
}

function endGame() {
    gameActive = false;
    clearInterval(spawnTimer);
    clearInterval(gameLoop);
    gameOverText.style.display = 'block';
    startBtn.style.display = 'inline-block';
    startBtn.innerText = 'RESTART';
}
